 {% extends "base.html" %}
 {% load mapa.models}
{% load bootstrap %}
{% load static %}
            {% load leaflet_tags %}
{% load geojson_tags %}


    

{% block content %}
<div class="container">
    <div class="panel">
        {% if request.user.is_authenticated %}
            <button><a  href="{% url 'poszukiwania:logout' %}">Wyloguj się</a></button>
            <button><a href="{% url 'poszukiwania:create' %} " >Dodaj pozycję</a></button>
        {% else %}
            <button><a href="{% url 'poszukiwania:login' %}" >Zaloguj się</a></button>
        {% endif %}
        {% if request.user.is_authenticated %}
        <select id="category_selected" onchange="location = this.value;">
                <option>Kategoria</option>
               <option value="{% url 'poszukiwania:rzeczy_list' %}">Wszystkie</option>
            {% for category in categories %}
               <option value="{{ category.get_absolute_url }}">{{ category.title }}</option>
            {% endfor %}
        </select>
        <form id="form_search">
            {% csrf_token %}
            <input placeholder="wyszukaj obiekt" id="input_search">
        </form>
    </div>
    <div class="nazwa">
       <select onchange="location = this.value">
            <option value=""><strong>Sortowanie wg.</strong></option>
            <option value="?sort={{ 'title' }}">title</option>
            <option value="?sort={{ 'year' }}">year</option>
            <option value="?sort={{ 'publish' }}">publikacja</option>
        </select>
    </div>
    <div class="list_search_objects not-visible"></div>
        {% if  kat %}
        {% leaflet_js %}
        {% leaflet_css %}
        {% endif %}
    <div  class="lista" style="background-color: white">


        <div id="lista">
            {% for rzecz in rzeczy %}
                <a href="{{ rzecz.get_absolute_url }}">
                    <div  {% if forloop.counter|divisibleby:2 %} class="ciemny"{% else %} class="jasny"{% endif %}>
                        <table>
                           <tr>
                               <td>
                                   <img style='width: 300px; height: 150px' src="{{ rzecz.image.url }}">
                               </td>
                           </tr>
                            <tr>
                                <td>
                                    <div style="float: left; font-size: 25px;">{{ rzecz.title }}</div>
                                    <div style="float: right; font-size: 20px;">{{ rzecz.year }}</div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </a>
            {% endfor %}
        </div>
        <div class="pagination">
            {% if rzeczy.has_previous %}
                <a class="pagination" href="?page={{ rzeczy.previous_page_number }}"><strong>Poprzednia </strong></a>
            {% endif %}
            Strona {{ rzeczy.number }} z {{ rzeczy.paginator.num_pages }}.
            {% if rzeczy.has_next %}
                <a class="pagination" href="?page={{ rzeczy.next_page_number }}"><strong> Następna</strong></a>
            {% endif %}
        </div>

    </div>
    {% endif %}
</div>
 <div class="mapid">
        <script type="text/javascript">
           var collection = {{ maps|geojsonfeature:":geolokalizacja"|safe }};
           function map_init(map, options) {
           L.geoJson(collection).addTo(map)}
        </script>
        {% leaflet_map 'Mapa' callback="window.map_init" %}
 </div>
<script type="text/javascript" src="{% static 'js/search.js' %}"></script>
{% endblock %}

